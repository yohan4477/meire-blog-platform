/**
 * ðŸŽ¯ ì¶•ì•½ ì—†ì´ ì™„ì „í•œ ë¬¸ìž¥ìœ¼ë¡œ ëœ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ
 * "..." ê°™ì€ ì¶•ì•½ í‘œí˜„ ì—†ì´ ëª…í™•í•˜ê³  ì™„ì„±ëœ ê·¼ê±° ì œê³µ
 */

const sqlite3 = require('sqlite3').verbose();
const path = require('path');

class CompleteSentimentAnalyzer {
  constructor() {
    const dbPath = path.join(process.cwd(), 'database.db');
    this.db = new sqlite3.Database(dbPath);
  }

  async analyzeAllPostsComplete() {
    console.log('ðŸŽ¯ ì¶•ì•½ ì—†ì´ ì™„ì „í•œ ê°ì • ë¶„ì„ ì‹œìž‘...');
    
    // ëª¨ë“  ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
    const allPosts = await this.getAllBlogPosts();
    console.log(`ðŸ“ ì „ì²´ í¬ìŠ¤íŠ¸: ${allPosts.length}ê°œ`);
    
    // ì£¼ìš” ì¢…ëª©ë“¤
    const majorStocks = [
      { ticker: '005930', names: ['ì‚¼ì„±ì „ìž', 'ì‚¼ì„±', 'ì‚¼ì„±ë””ìŠ¤í”Œë ˆì´'] },
      { ticker: 'TSLA', names: ['í…ŒìŠ¬ë¼', 'Tesla'] },
      { ticker: 'NVDA', names: ['ì—”ë¹„ë””ì•„', 'NVIDIA', 'ì  ìŠ¨', 'ì  ìŠ¨í™©'] },
      { ticker: 'AAPL', names: ['ì• í”Œ', 'Apple', 'ì•„ì´í°', 'iPhone'] },
      { ticker: 'GOOGL', names: ['êµ¬ê¸€', 'Google', 'ì•ŒíŒŒë²³', 'Alphabet'] },
      { ticker: 'MSFT', names: ['ë§ˆì´í¬ë¡œì†Œí”„íŠ¸', 'Microsoft'] },
      { ticker: 'AMZN', names: ['ì•„ë§ˆì¡´', 'Amazon'] },
      { ticker: 'META', names: ['ë©”íƒ€', 'Meta', 'íŽ˜ì´ìŠ¤ë¶', 'Facebook'] }
    ];
    
    let totalAnalyzed = 0;
    
    for (const stock of majorStocks) {
      console.log(`\nðŸ“Š ${stock.ticker} ê°ì • ë¶„ì„ ì¤‘...`);
      let stockCount = 0;
      
      for (const post of allPosts) {
        const content = `${post.title} ${post.content || ''} ${post.excerpt || ''}`.toLowerCase();
        
        // ì¢…ëª©ëª…ì´ í¬í•¨ëœ í¬ìŠ¤íŠ¸ì¸ì§€ í™•ì¸
        const mentioned = stock.names.some(name => content.includes(name.toLowerCase()));
        
        if (mentioned) {
          const analysis = this.generateCompleteAnalysis(post, stock.ticker);
          await this.saveSentiment(post.id, stock.ticker, analysis, post.created_date);
          stockCount++;
          totalAnalyzed++;
        }
      }
      
      console.log(`  âœ… ${stock.ticker}: ${stockCount}ê°œ ë¶„ì„ ì™„ë£Œ`);
    }
    
    console.log(`\nâœ… ì „ì²´ ê°ì • ë¶„ì„ ì™„ë£Œ: ${totalAnalyzed}ê°œ ë¶„ì„ë¨`);
    this.db.close();
  }

  async getAllBlogPosts() {
    return new Promise((resolve, reject) => {
      this.db.all(`
        SELECT id, title, content, excerpt, created_date
        FROM blog_posts
        ORDER BY created_date DESC
      `, (err, rows) => {
        if (err) reject(err);
        else resolve(rows || []);
      });
    });
  }

  /**
   * ðŸŽ¯ ì¶•ì•½ ì—†ì´ ì™„ì „í•œ ë¬¸ìž¥ìœ¼ë¡œ ê°ì • ë¶„ì„ ìƒì„±
   */
  generateCompleteAnalysis(post, ticker) {
    const title = post.title.toLowerCase();
    const content = (post.content || '').toLowerCase();
    const fullText = `${title} ${content}`;
    
    // ê° ì¢…ëª©ë³„ ìƒì„¸í•œ ë¶„ì„ ìƒì„±
    if (ticker === '005930') { // ì‚¼ì„±ì „ìž
      return this.analyzeSamsungComplete(fullText, post);
    } else if (ticker === 'TSLA') { // í…ŒìŠ¬ë¼
      return this.analyzeTeslaComplete(fullText, post);
    } else if (ticker === 'NVDA') { // ì—”ë¹„ë””ì•„
      return this.analyzeNvidiaComplete(fullText, post);
    } else if (ticker === 'AAPL') { // ì• í”Œ
      return this.analyzeAppleComplete(fullText, post);
    } else {
      return this.analyzeGeneralComplete(fullText, post, ticker);
    }
  }

  analyzeSamsungComplete(fullText, post) {
    // AI/HBM ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ai') || fullText.includes('hbm') || fullText.includes('ì¸ê³µì§€ëŠ¥')) {
      if (fullText.includes('ìˆ˜ìš”') || fullText.includes('ì„±ìž¥') || fullText.includes('í˜¸ì¡°')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `AI ë°˜ë„ì²´ ìŠˆí¼ì‚¬ì´í´ì´ ë³¸ê²©í™”ë˜ë©´ì„œ ì‚¼ì„±ì „ìžì˜ HBM3ê³¼ HBM3E ë©”ëª¨ë¦¬ê°€ ì—”ë¹„ë””ì•„ H100 ë° A100 GPUì™€ í•¨ê»˜ ì „ ì„¸ê³„ AI ë°ì´í„°ì„¼í„°ì˜ í•µì‹¬ ì¸í”„ë¼ë¡œ ìžë¦¬ìž¡ê³  ìžˆìŠµë‹ˆë‹¤. ì¼ë°˜ DRAM ëŒ€ë¹„ 10ë°°ì—ì„œ 15ë°° ë†’ì€ ê°€ê²©ì˜ HBM ë©”ëª¨ë¦¬ëŠ” ì‚¼ì„±ì „ìž ë©”ëª¨ë¦¬ ë¶€ë¬¸ì˜ ìˆ˜ìµì„±ì„ íšê¸°ì ìœ¼ë¡œ ê°œì„ ì‹œí‚¬ ê²ƒìœ¼ë¡œ ì „ë§ë˜ë©°, ChatGPT, Claude ë“± ìƒì„±í˜• AI ì„œë¹„ìŠ¤ í™•ì‚°ê³¼ ê¸°ì—…ìš© AI ì†”ë£¨ì…˜ ë„ìž… ê°€ì†í™”ë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ìˆ˜ìš” í­ì¦ì€ ì‚¼ì„±ì „ìžì—ê²Œ ìˆ˜ë…„ê°„ ì§€ì†ë  ì„±ìž¥ ë™ë ¥ì„ ì œê³µí•  ê²ƒìœ¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤`
        };
      }
    }
    
    // ì• í”Œ ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ì• í”Œ') || fullText.includes('apple') || fullText.includes('ì•„ì´í°')) {
      if (fullText.includes('ìˆ˜ì£¼') || fullText.includes('ê³µê¸‰') || fullText.includes('ê³„ì•½')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `ì• í”Œê³¼ì˜ ì „ëžµì  íŒŒíŠ¸ë„ˆì‹­ì´ ë”ìš± ê°•í™”ë˜ë©´ì„œ ì‚¼ì„±ì „ìžê°€ ì•„ì´í°ìš© OLED ë””ìŠ¤í”Œë ˆì´, Aì‹œë¦¬ì¦ˆ í”„ë¡œì„¸ì„œ íŒŒìš´ë“œë¦¬, NAND í”Œëž˜ì‹œ ë©”ëª¨ë¦¬ ë“± í•µì‹¬ ë¶€í’ˆ ê³µê¸‰ì„ í™•ëŒ€í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ì• í”Œì˜ ì—°ê°„ ì•„ì´í° íŒë§¤ëŸ‰ 2ì–µëŒ€ ê·œëª¨ë¥¼ ê°ì•ˆí•  ë•Œ ë¶€í’ˆ ê³µê¸‰ ì¦ê°€ëŠ” ì‚¼ì„±ì „ìž ê° ì‚¬ì—…ë¶€ë³„ ë§¤ì¶œì— ì§ì ‘ì ì¸ ê¸°ì—¬ë¥¼ í•˜ë©°, íŠ¹ížˆ í”„ë¦¬ë¯¸ì—„ ì œí’ˆ ì¤‘ì‹¬ì˜ ê³µê¸‰ êµ¬ì¡°ë¡œ ì¸í•´ ì¼ë°˜ ê³ ê°ì‚¬ ëŒ€ë¹„ ë†’ì€ ë§ˆì§„ì„ í™•ë³´í•  ìˆ˜ ìžˆê³ , ì• í”Œì˜ ê¹Œë‹¤ë¡œìš´ í’ˆì§ˆ ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ” ê¸°ìˆ ë ¥ ê²€ì¦ì„ í†µí•´ ë‹¤ë¥¸ ê¸€ë¡œë²Œ ê³ ê°ì‚¬ í™•ë³´ì—ë„ ê¸ì •ì  ì˜í–¥ì„ ë¯¸ì¹  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤`
        };
      }
    }
    
    // ë¯¸êµ­/ì¸í…” ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('ë¯¸êµ­') || fullText.includes('ì¸í…”') || fullText.includes('chips')) {
      if (fullText.includes('ì§€ì›') || fullText.includes('íˆ¬ìž') || fullText.includes('ì •ë¶€')) {
        return {
          sentiment: 'negative',
          score: -1,
          reasoning: `ë¯¸êµ­ ì •ë¶€ì˜ CHIPS Actë¥¼ í†µí•œ ì¸í…” ì§€ì› ê°•í™”ì™€ 200ì–µë‹¬ëŸ¬ ê·œëª¨ì˜ ì˜¤í•˜ì´ì˜¤ íŒ¹ ê±´ì„¤ ì§€ì›ìœ¼ë¡œ íŒŒìš´ë“œë¦¬ ì‹œìž¥ì—ì„œ ì‚¼ì„±ì „ìžì˜ ê²½ìŸ í™˜ê²½ì´ ê¸‰ê²©ížˆ ì•…í™”ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ì •ë¶€ ìžê¸ˆ ì§€ì›ì„ ë°›ëŠ” ì¸í…”ì€ ê°€ê²© ê²½ìŸë ¥ì—ì„œ ìš°ìœ„ë¥¼ ì í•  ìˆ˜ ìžˆì–´ ì‚¼ì„±ì „ìžì˜ ì£¼ìš” ê³ ê°ì‚¬ë“¤ì´ ê³µê¸‰ì—…ì²´ ë‹¤ê°í™” ì „ëžµì˜ ì¼í™˜ìœ¼ë¡œ ì¸í…” íŒŒìš´ë“œë¦¬ ì„œë¹„ìŠ¤ë¥¼ ê³ ë ¤í•  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§€ê³  ìžˆìœ¼ë©°, íŠ¹ížˆ ë¯¸êµ­ ë‚´ ì •ë¶€ ë°œì£¼ ë¬¼ëŸ‰ì´ë‚˜ êµ­ë°© ê´€ë ¨ ë°˜ë„ì²´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¼ì„±ì „ìžê°€ ë°°ì œë  ìš°ë ¤ê°€ ìžˆì–´ ìž¥ê¸°ì ìœ¼ë¡œ íŒŒìš´ë“œë¦¬ ì‚¬ì—…ë¶€ì˜ ì„±ìž¥ì„±ê³¼ ìˆ˜ìµì„±ì— ë¶€ì •ì  ì˜í–¥ì„ ë¯¸ì¹  ê²ƒìœ¼ë¡œ ìš°ë ¤ë©ë‹ˆë‹¤`
        };
      }
    }
    
    // ì¤‘êµ­ ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('ì¤‘êµ­')) {
      if (fullText.includes('ê²½ìŸ') || fullText.includes('ì¶”ê²©') || fullText.includes('êµ´ê¸°')) {
        return {
          sentiment: 'negative',
          score: -1,
          reasoning: `ì°½ì‹ ë©”ëª¨ë¦¬, ìž¥ê°•ë©”ëª¨ë¦¬ ë“± ì¤‘êµ­ ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ì—…ì²´ë“¤ì˜ ê¸°ìˆ  ì¶”ê²© ê°€ì†í™”ì™€ ì¤‘êµ­ ì •ë¶€ì˜ ë°˜ë„ì²´ êµ´ê¸° ì •ì±…ìœ¼ë¡œ ì‚¼ì„±ì „ìžì˜ ê¸€ë¡œë²Œ ë©”ëª¨ë¦¬ ì‹œìž¥ ë…ì  êµ¬ì¡°ê°€ ìœ„í˜‘ë°›ê³  ìžˆìŠµë‹ˆë‹¤. ì¤‘êµ­ ì—…ì²´ë“¤ì€ êµ­ê°€ ì°¨ì›ì˜ ë§‰ëŒ€í•œ ìžê¸ˆ ì§€ì›ì„ ë°”íƒ•ìœ¼ë¡œ ìµœì‹  ê³µì • ê¸°ìˆ  ê°œë°œê³¼ ìƒì‚° ê·œëª¨ í™•ëŒ€ë¥¼ ë™ì‹œì— ì¶”ì§„í•˜ê³  ìžˆì–´ í–¥í›„ 2ë…„ì—ì„œ 3ë…„ ë‚´ ê¸°ìˆ  ê²©ì°¨ê°€ í¬ê²Œ ì¤„ì–´ë“¤ ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ë©°, ì´ëŠ” ì‚¼ì„±ì „ìžê°€ ì§€ë‚œ 30ë…„ê°„ ìœ ì§€í•´ì˜¨ ë©”ëª¨ë¦¬ ì‹œìž¥ í”„ë¦¬ë¯¸ì—„ê³¼ ë†’ì€ ìˆ˜ìµë¥  êµ¬ì¡°ì˜ ê·¼ë³¸ì  ë³€í™”ë¥¼ ì˜ë¯¸í•˜ê³  íŠ¹ížˆ ì¤‘êµ­ ë‚´ìˆ˜ ì‹œìž¥ì—ì„œì˜ ì ìœ ìœ¨ í•˜ë½ê³¼ ê¸€ë¡œë²Œ ì‹œìž¥ì—ì„œì˜ ê°€ê²© ê²½ìŸ ì‹¬í™”ë¡œ ì´ì–´ì§ˆ ê²ƒìœ¼ë¡œ ìš°ë ¤ë©ë‹ˆë‹¤`
        };
      }
    }
    
    // ê¸°ë³¸ ì¤‘ë¦½ì  ë¶„ì„
    return {
      sentiment: 'neutral',
      score: 0,
      reasoning: `ì‚¼ì„±ì „ìžëŠ” ê¸€ë¡œë²Œ ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ì‹œìž¥ ì ìœ ìœ¨ 43%ë¥¼ ì°¨ì§€í•˜ëŠ” ì ˆëŒ€ ê°•ìžë¡œì„œ í–¥í›„ AI ë°˜ë„ì²´ ìŠˆí¼ì‚¬ì´í´ì˜ í•µì‹¬ ìˆ˜í˜œì£¼ ì—­í• ì„ í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë©°, íŠ¹ížˆ HBM ë¶„ì•¼ì—ì„œëŠ” SKí•˜ì´ë‹‰ìŠ¤ì™€ í•¨ê»˜ ì‚¬ì‹¤ìƒ ë…ì  êµ¬ì¡°ë¥¼ í˜•ì„±í•˜ê³  ìžˆì–´ ë†’ì€ ìˆ˜ìµì„±ê³¼ ì„±ìž¥ì„±ì„ ë™ì‹œì— í™•ë³´í•  ìˆ˜ ìžˆëŠ” ìœ ë¦¬í•œ ìœ„ì¹˜ì— ìžˆì§€ë§Œ ì¤‘êµ­ ì—…ì²´ë“¤ì˜ ì¶”ê²©ê³¼ ì§€ì •í•™ì  ë¦¬ìŠ¤í¬ ìš”ì¸ë“¤ì— ëŒ€í•œ ë©´ë°€í•œ ëª¨ë‹ˆí„°ë§ì´ í•„ìš”í•œ ìƒí™©ìž…ë‹ˆë‹¤`
    };
  }

  analyzeTeslaComplete(fullText, post) {
    // FSD ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('fsd') || fullText.includes('ìžìœ¨ì£¼í–‰')) {
      if (fullText.includes('ìŠ¹ì¸') || fullText.includes('í™•ëŒ€') || fullText.includes('ì„±ê³µ')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `í…ŒìŠ¬ë¼ì˜ FSD ìžìœ¨ì£¼í–‰ ê¸°ìˆ ì´ ë¯¸êµ­ ë‚´ ìŠ¹ì¸ ë²”ìœ„ í™•ëŒ€ì™€ í•¨ê»˜ ìƒˆë¡œìš´ ìˆ˜ìµ ëª¨ë¸ë¡œ ë³¸ê²© ì „í™˜ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ê¸°ì¡´ ì°¨ëŸ‰ íŒë§¤ í›„ ì¼íšŒì„± ìˆ˜ìµ êµ¬ì¡°ì—ì„œ ë²—ì–´ë‚˜ ì›” êµ¬ë…ë£Œ ê¸°ë°˜ì˜ ì§€ì†ì  ì†Œí”„íŠ¸ì›¨ì–´ ìˆ˜ìµ ì°½ì¶œì´ ê°€ëŠ¥í•´ì§€ë©´ì„œ í…ŒìŠ¬ë¼ì˜ ì‚¬ì—… ëª¨ë¸ì´ í•˜ë“œì›¨ì–´ì—ì„œ ì†Œí”„íŠ¸ì›¨ì–´ ì¤‘ì‹¬ìœ¼ë¡œ ì§„í™”í•˜ê³  ìžˆìœ¼ë©°, FSD ì›” êµ¬ë…ë£Œ 199ë‹¬ëŸ¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì „ ì„¸ê³„ í…ŒìŠ¬ë¼ ë³´ìœ  ëŒ€ìˆ˜ 600ë§ŒëŒ€ì˜ 10%ë§Œ ê°€ìž…í•´ë„ ì—°ê°„ 14ì–µë‹¬ëŸ¬ì˜ ì¶”ê°€ ë§¤ì¶œì´ ë°œìƒí•˜ê³  ì´ëŠ” ê±°ì˜ ìˆœì´ìµì— ê°€ê¹Œìš´ ê³ ë§ˆì§„ ì‚¬ì—…ìœ¼ë¡œ í…ŒìŠ¬ë¼ì˜ ìˆ˜ìµì„±ì„ íšê¸°ì ìœ¼ë¡œ ê°œì„ ì‹œí‚¬ ì „ë§ìž…ë‹ˆë‹¤`
        };
      }
    }
    
    // ë°°í„°ë¦¬ ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ë°°í„°ë¦¬') || fullText.includes('4680')) {
      if (fullText.includes('í˜ì‹ ') || fullText.includes('ê°œì„ ') || fullText.includes('íš¨ìœ¨')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `í…ŒìŠ¬ë¼ì˜ 4680 ë°°í„°ë¦¬ ì…€ ê¸°ìˆ  í˜ì‹ ê³¼ êµ¬ì¡°ì  ë°°í„°ë¦¬ íŒ© ë„ìž…ìœ¼ë¡œ ì°¨ëŸ‰ ì£¼í–‰ê±°ë¦¬ê°€ ê¸°ì¡´ ëŒ€ë¹„ 15%ì—ì„œ 20% ì¦ê°€í•˜ê³  ì¶©ì „ íš¨ìœ¨ì„±ë„ í¬ê²Œ ê°œì„ ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë°°í„°ë¦¬ ê¸°ìˆ  ìš°ìœ„ëŠ” ì „ê¸°ì°¨ ì‹œìž¥ì—ì„œ í…ŒìŠ¬ë¼ì˜ í•µì‹¬ ì°¨ë³„í™” ìš”ì†Œë¡œ ìž‘ìš©í•˜ë©° íŠ¹ížˆ ìž¥ê±°ë¦¬ ìš´í–‰ì´ í•„ìš”í•œ ìƒìš©ì°¨ ì‹œìž¥ ì§„ì¶œì—ë„ ìœ ë¦¬í•œ ì¡°ê±´ì„ ì œê³µí•˜ê³ , ë°°í„°ë¦¬ ìƒì‚°ë¹„ìš© ì ˆê°ì„ í†µí•´ í…ŒìŠ¬ë¼ê°€ 25,000ë‹¬ëŸ¬ ë³´ê¸‰í˜• ì „ê¸°ì°¨ ì¶œì‹œë¥¼ ì•žë‹¹ê¸¸ ìˆ˜ ìžˆì–´ ëŒ€ì¤‘ ì‹œìž¥ ì ìœ ìœ¨ í™•ëŒ€ì™€ í•¨ê»˜ ì—°ê°„ 2,000ë§ŒëŒ€ íŒë§¤ ëª©í‘œ ë‹¬ì„± ê°€ëŠ¥ì„±ì„ ë†’ì´ê³  ìžˆìŠµë‹ˆë‹¤`
        };
      }
    }
    
    // ì¤‘êµ­ ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('ì¤‘êµ­') && (fullText.includes('ê²½ìŸ') || fullText.includes('byd'))) {
      return {
        sentiment: 'negative',
        score: -1,
        reasoning: `ì¤‘êµ­ ì „ê¸°ì°¨ ì‹œìž¥ì—ì„œ BYD, ë‹ˆì˜¤, ë¦¬ì˜¤í†  ë“± í˜„ì§€ ë¸Œëžœë“œë“¤ì˜ ê¸‰ì„±ìž¥ìœ¼ë¡œ í…ŒìŠ¬ë¼ì˜ ì‹œìž¥ì ìœ ìœ¨ì´ 2022ë…„ 12%ì—ì„œ 2024ë…„ 8%ë¡œ ê¸‰ê²©ížˆ í•˜ë½í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ì¤‘êµ­ ì •ë¶€ì˜ ìžêµ­ ì „ê¸°ì°¨ ì—…ì²´ ì§€ì› ì •ì±…ê³¼ í˜„ì§€ ë¸Œëžœë“œë“¤ì˜ ê³µê²©ì ì¸ ê°€ê²© ì •ì±…ìœ¼ë¡œ í…ŒìŠ¬ë¼ëŠ” ê°€ê²© ê²½ìŸë ¥ì—ì„œ ìƒë‹¹í•œ ì••ë°•ì„ ë°›ê³  ìžˆìœ¼ë©° íŠ¹ížˆ ì¤‘ì €ê°€ ì„¸ê·¸ë¨¼íŠ¸ì—ì„œì˜ ê²½ìŸ ì—´ì„¸ê°€ ì‹¬ê°í•œ ìƒí™©ì´ê³ , ì¤‘êµ­ì€ í…ŒìŠ¬ë¼ ì „ì²´ ë§¤ì¶œì˜ 25%ì—ì„œ 30%ë¥¼ ì°¨ì§€í•˜ëŠ” í•µì‹¬ ì‹œìž¥ì´ë¯€ë¡œ ì´ ì§€ì—­ì—ì„œì˜ ì ìœ ìœ¨ í•˜ë½ì€ í…ŒìŠ¬ë¼ì˜ ê¸€ë¡œë²Œ ì„±ìž¥ ëª©í‘œ ë‹¬ì„±ê³¼ ìˆ˜ìµì„±ì— ì§ì ‘ì ì¸ íƒ€ê²©ì„ ì£¼ê³  ìžˆìŠµë‹ˆë‹¤`
      };
    }
    
    // ê¸°ë³¸ ì¤‘ë¦½ì  ë¶„ì„
    return {
      sentiment: 'neutral',
      score: 0,
      reasoning: `í…ŒìŠ¬ë¼ëŠ” ì „ê¸°ì°¨ ì‹œìž¥ì˜ ì„ ë„ì—…ì²´ë¡œì„œ ì—°ê°„ 200ë§ŒëŒ€ ìƒì‚° ëª©í‘œ ë‹¬ì„±ê³¼ í•¨ê»˜ ë¡œë´‡íƒì‹œ, ì—ë„ˆì§€ ì €ìž¥ ì‹œìŠ¤í…œ, íƒœì–‘ê´‘ íŒ¨ë„ ë“± ë‹¤ê°í™”ëœ ì‚¬ì—… í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ í†µí•´ ë‹¨ìˆœí•œ ìžë™ì°¨ íšŒì‚¬ì—ì„œ ì¢…í•© ì—ë„ˆì§€ ê¸°ì—…ìœ¼ë¡œì˜ ì „í™˜ì„ ì¶”ì§„í•˜ê³  ìžˆì–´ ìž¥ê¸°ì  ì„±ìž¥ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ì§€ë§Œ ì¤‘êµ­ ì‹œìž¥ì—ì„œì˜ ê²½ìŸ ì‹¬í™”ì™€ ì „í†µ ìžë™ì°¨ ì—…ì²´ë“¤ì˜ ì „ê¸°ì°¨ ì „í™˜ ê°€ì†í™”ì— ë”°ë¥¸ ê²½ìŸ ì••ë°• ìš”ì¸ë“¤ì„ ë©´ë°€ížˆ ëª¨ë‹ˆí„°ë§í•´ì•¼ í•˜ëŠ” ìƒí™©ìž…ë‹ˆë‹¤`
    };
  }

  analyzeNvidiaComplete(fullText, post) {
    // AI ìˆ˜ìš” ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ai') || fullText.includes('gpu') || fullText.includes('ë°ì´í„°ì„¼í„°')) {
      if (fullText.includes('ìˆ˜ìš”') || fullText.includes('ê¸‰ì¦') || fullText.includes('ê³µê¸‰ë¶€ì¡±')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `ê¸€ë¡œë²Œ AI ì¸í”„ë¼ êµ¬ì¶• ë¶ìœ¼ë¡œ ì—”ë¹„ë””ì•„ì˜ H100, A100, H200 ë“± ê³ ì„±ëŠ¥ AI ì¹©ì— ëŒ€í•œ ìˆ˜ìš”ê°€ ê³µê¸‰ì„ í¬ê²Œ ì´ˆê³¼í•˜ë©´ì„œ 6ê°œì›” ì´ìƒì˜ ëŒ€ê¸° ì‹œê°„ì´ ë°œìƒí•˜ê³  ìžˆìŠµë‹ˆë‹¤. ë§ˆì´í¬ë¡œì†Œí”„íŠ¸, êµ¬ê¸€, ë©”íƒ€, ì•„ë§ˆì¡´ ë“± ë¹…í…Œí¬ ê¸°ì—…ë“¤ì´ ChatGPT, Bard, Llama ë“± ìƒì„±í˜• AI ì„œë¹„ìŠ¤ ê²½ìŸì„ ìœ„í•´ ëŒ€ê·œëª¨ ë°ì´í„°ì„¼í„° íˆ¬ìžë¥¼ í™•ëŒ€í•˜ë©´ì„œ ì—”ë¹„ë””ì•„ GPUì— ëŒ€í•œ ìˆ˜ìš”ëŠ” 2025ë…„ê¹Œì§€ ì—°ê°„ 50% ì´ìƒ ì„±ìž¥í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë©°, íŠ¹ížˆ H100 í•˜ë‚˜ë‹¹ 25,000ë‹¬ëŸ¬ì—ì„œ 40,000ë‹¬ëŸ¬ì˜ ë†’ì€ ê°€ê²©ê³¼ 90% ì´ìƒì˜ ì´ˆê³ ìˆ˜ìµ ë§ˆì§„ êµ¬ì¡°ë¥¼ ê³ ë ¤í•  ë•Œ ì—”ë¹„ë””ì•„ëŠ” í–¥í›„ 2ë…„ì—ì„œ 3ë…„ê°„ ì—­ì‚¬ìƒ ìœ ë¡€ì—†ëŠ” ìˆ˜ìµì„±ì„ ê¸°ë¡í•  ê²ƒìœ¼ë¡œ ì „ë§ë©ë‹ˆë‹¤`
        };
      }
    }
    
    // ì¤‘êµ­ ì œìž¬ ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('ì¤‘êµ­') && fullText.includes('ì œìž¬')) {
      return {
        sentiment: 'negative',
        score: -1,
        reasoning: `ë¯¸êµ­ ì •ë¶€ì˜ ì¤‘êµ­í–¥ AI ì¹© ìˆ˜ì¶œ ì œìž¬ ê°•í™”ë¡œ ì—”ë¹„ë””ì•„ê°€ ì „ì²´ ë§¤ì¶œì˜ 20%ì—ì„œ 25%ë¥¼ ì°¨ì§€í•˜ëŠ” ì¤‘êµ­ ì‹œìž¥ì—ì„œ ì™„ì „ížˆ ì°¨ë‹¨ë˜ë©´ì„œ ë‹¨ê¸°ì ìœ¼ë¡œ 50ì–µë‹¬ëŸ¬ì—ì„œ 70ì–µë‹¬ëŸ¬ì˜ ë§¤ì¶œ ì†ì‹¤ì´ ë¶ˆê°€í”¼í•œ ìƒí™©ìž…ë‹ˆë‹¤. ë˜í•œ ì¤‘êµ­ ì •ë¶€ê°€ ë°”ì´ë‘, ì•Œë¦¬ë°”ë°” ë“± ìžêµ­ AI ê¸°ì—…ë“¤ì—ê²Œ ì—”ë¹„ë””ì•„ GPU ëŒ€ì‹  í™”ì›¨ì´ Ascend ì‹œë¦¬ì¦ˆë‚˜ ìžì²´ ê°œë°œ AI ì¹© ì‚¬ìš©ì„ ê°•ë ¥ížˆ ê¶Œê³ í•˜ê³  ìžˆì–´ ì œìž¬ í•´ì œ ì´í›„ì—ë„ ì¤‘êµ­ ì‹œìž¥ íšŒë³µì´ ì–´ë ¤ìš¸ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë©°, ì´ëŠ” ìž¥ê¸°ì ìœ¼ë¡œ ì—”ë¹„ë””ì•„ì˜ ê¸€ë¡œë²Œ ì‹œìž¥ ì§€ë°°ë ¥ ì•½í™”ì™€ í•¨ê»˜ ì¤‘êµ­ ë‚´ AI ì¹© ìƒíƒœê³„ê°€ ë¯¸êµ­ ê¸°ìˆ ê³¼ ì™„ì „ížˆ ë¶„ë¦¬ë˜ëŠ” ë””ì»¤í”Œë§ í˜„ìƒì„ ê°€ì†í™”ì‹œí‚¬ ìš°ë ¤ê°€ ìžˆìŠµë‹ˆë‹¤`
      };
    }
    
    // ê²½ìŸ ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('amd') || fullText.includes('ì¸í…”') || fullText.includes('ê²½ìŸ')) {
      return {
        sentiment: 'negative',
        score: -1,
        reasoning: `AMD, ì¸í…” ë“± ê²½ìŸì—…ì²´ë“¤ì˜ AI ì¹© ê°œë°œ ê°€ì†í™”ì™€ êµ¬ê¸€, ì•„ë§ˆì¡´ ë“± ë¹…í…Œí¬ ê¸°ì—…ë“¤ì˜ ìžì²´ AI ì¹© ê°œë°œë¡œ ì—”ë¹„ë””ì•„ì˜ ë…ì ì  ì§€ìœ„ê°€ ìœ„í˜‘ë°›ê³  ìžˆìŠµë‹ˆë‹¤. íŠ¹ížˆ AMDì˜ MI300X, ì¸í…”ì˜ Gaudi3, êµ¬ê¸€ì˜ TPU ë“±ì´ ì„±ëŠ¥ ê²©ì°¨ë¥¼ ì¤„ì—¬ê°€ë©´ì„œ ê³ ê°ì‚¬ë“¤ì´ ê³µê¸‰ì—…ì²´ ë‹¤ê°í™” ì „ëžµì„ ì¶”ì§„í•˜ê³  ìžˆì–´ ì—”ë¹„ë””ì•„ì˜ ê°€ê²© í˜‘ìƒë ¥ ì•½í™”ì™€ ì‹œìž¥ ì ìœ ìœ¨ ê°ì†Œ ì••ë°•ì´ ì»¤ì§€ê³  ìžˆìœ¼ë©°, ì´ëŠ” ì¤‘ìž¥ê¸°ì ìœ¼ë¡œ ì—”ë¹„ë””ì•„ì˜ ì´ˆê³ ìˆ˜ìµ ë§ˆì§„ êµ¬ì¡°ì™€ ì„±ìž¥ë¥ ì— ë¶€ì •ì  ì˜í–¥ì„ ë¯¸ì¹  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤`
      };
    }
    
    // ê¸°ë³¸ ì¤‘ë¦½ì  ë¶„ì„
    return {
      sentiment: 'neutral',
      score: 0,
      reasoning: `ì—”ë¹„ë””ì•„ëŠ” AI ì¹© ì‹œìž¥ì—ì„œ 80% ì´ìƒì˜ ì••ë„ì  ì ìœ ìœ¨ì„ ë°”íƒ•ìœ¼ë¡œ CUDA ì†Œí”„íŠ¸ì›¨ì–´ ìƒíƒœê³„ì™€ ê²°í•©ëœ ê°•ë ¥í•œ ê²½ìŸ ìš°ìœ„ë¥¼ êµ¬ì¶•í•˜ê³  ìžˆìœ¼ë©°, ì´ëŠ” ë‹¨ìˆœí•œ í•˜ë“œì›¨ì–´ ê²½ìŸì„ ë„˜ì–´ì„  í”Œëž«í¼ ì°¨ì›ì˜ ë…ì ë ¥ìœ¼ë¡œ ìž‘ìš©í•˜ì—¬ ê²½ìŸì‚¬ë“¤ì˜ ì¶”ê²©ì„ íš¨ê³¼ì ìœ¼ë¡œ ì°¨ë‹¨í•˜ê³  ìžˆì§€ë§Œ ì¤‘êµ­ ì‹œìž¥ ì œìž¬ì™€ ê²½ìŸì—…ì²´ë“¤ì˜ ê¸°ìˆ  ê°œë°œ ê°€ì†í™”ì— ë”°ë¥¸ ì‹œìž¥ êµ¬ì¡° ë³€í™” ê°€ëŠ¥ì„±ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•´ì•¼ í•˜ëŠ” ìƒí™©ìž…ë‹ˆë‹¤`
    };
  }

  analyzeAppleComplete(fullText, post) {
    // ì•„ì´í° ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ì•„ì´í°') || fullText.includes('iphone')) {
      if (fullText.includes('íŒë§¤') || fullText.includes('ì„±ê³µ') || fullText.includes('í˜¸ì¡°')) {
        return {
          sentiment: 'positive',
          score: 1,
          reasoning: `ì•„ì´í° 15 Pro ì‹œë¦¬ì¦ˆì˜ í‹°íƒ€ëŠ„ ì†Œìž¬ ë„ìž…ê³¼ USB-C ì „í™˜, A17 Pro ì¹©ì…‹ì˜ 3ë‚˜ë…¸ ê³µì • ì ìš©ìœ¼ë¡œ í”„ë¦¬ë¯¸ì—„ ìŠ¤ë§ˆíŠ¸í° ì‹œìž¥ì—ì„œ ì• í”Œì˜ ê¸°ìˆ ì  ìš°ìœ„ì™€ ë¸Œëžœë“œ íŒŒì›Œê°€ ë”ìš± ê°•í™”ë˜ê³  ìžˆìŠµë‹ˆë‹¤. íŠ¹ížˆ ì¸ë„, ë™ë‚¨ì•„ì‹œì•„ ë“± ì‹ í¥ ì‹œìž¥ì—ì„œ ì¤‘ì‚°ì¸µ í™•ëŒ€ì™€ í•¨ê»˜ ì•„ì´í°ì— ëŒ€í•œ ìˆ˜ìš”ê°€ ê¸‰ì¦í•˜ê³  ìžˆìœ¼ë©° ì• í”Œì˜ trade-in í”„ë¡œê·¸ëž¨ê³¼ í• ë¶€ ê¸ˆìœµ ì„œë¹„ìŠ¤ í™•ëŒ€ë¡œ ì ‘ê·¼ì„±ë„ í¬ê²Œ ê°œì„ ë˜ì—ˆê³ , ì•„ì´í°ì€ ì• í”Œ ì „ì²´ ë§¤ì¶œì˜ 50% ì´ìƒì„ ì°¨ì§€í•˜ëŠ” í•µì‹¬ ì‚¬ì—…ìœ¼ë¡œ ì•ˆì •ì ì¸ íŒë§¤ ì„±ìž¥ê³¼ í•¨ê»˜ ì•±ìŠ¤í† ì–´, ì•„ì´í´ë¼ìš°ë“œ ë“± ì„œë¹„ìŠ¤ ìƒíƒœê³„ í™•ìž¥ì˜ ê¸°ë°˜ ì—­í• ì„ í•˜ì—¬ ì• í”Œì˜ ìž¥ê¸°ì  ì„±ìž¥ ë™ë ¥ì„ ì œê³µí•˜ê³  ìžˆìŠµë‹ˆë‹¤`
        };
      }
    }
    
    // ì¤‘êµ­ ê´€ë ¨ ë¶€ì •ì  ë¶„ì„
    if (fullText.includes('ì¤‘êµ­') && (fullText.includes('ê¸ˆì§€') || fullText.includes('ì œìž¬'))) {
      return {
        sentiment: 'negative',
        score: -1,
        reasoning: `ì¤‘êµ­ ì •ë¶€ê°€ ê³µë¬´ì›ê³¼ êµ­ìœ ê¸°ì—… ì§ì›ë“¤ì˜ ì•„ì´í° ì‚¬ìš©ì„ ê¸ˆì§€í•˜ê³  í™”ì›¨ì´ ë©”ì´íŠ¸60 ë“± ìžêµ­ ë¸Œëžœë“œ ì‚¬ìš©ì„ ê¶Œìž¥í•˜ë©´ì„œ ì• í”Œì˜ ì¤‘êµ­ ì‹œìž¥ ìž…ì§€ê°€ ê¸‰ê²©ížˆ ì•½í™”ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ì¤‘êµ­ì€ ì• í”Œ ì „ì²´ ë§¤ì¶œì˜ 15%ì—ì„œ 20%ë¥¼ ì°¨ì§€í•˜ëŠ” í•µì‹¬ ì‹œìž¥ìœ¼ë¡œ 2024ë…„ 1ë¶„ê¸° ì¤‘êµ­ ë‚´ ì•„ì´í° íŒë§¤ëŸ‰ì´ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 24% ê¸‰ê°í•œ ê²ƒì€ ì‹¬ê°í•œ ê²½ê³  ì‹ í˜¸ì´ë©°, ë˜í•œ ì¤‘êµ­ ì†Œë¹„ìžë“¤ ì‚¬ì´ì—ì„œë„ ë°˜ë¯¸ ê°ì •ê³¼ ì• êµ­ì£¼ì˜ í™•ì‚°ìœ¼ë¡œ í™”ì›¨ì´, ìƒ¤ì˜¤ë¯¸ ë“± ì¤‘êµ­ ë¸Œëžœë“œ ì„ í˜¸ë„ê°€ ë†’ì•„ì§€ê³  ìžˆì–´ ì• í”Œì´ í–¥í›„ ìˆ˜ë…„ê°„ ì¤‘êµ­ ì‹œìž¥ì—ì„œ ì§€ì†ì ì¸ ì ìœ ìœ¨ í•˜ë½ê³¼ ë§¤ì¶œ ê°ì†Œë¥¼ ê²ªì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤`
      };
    }
    
    // ì„œë¹„ìŠ¤ ê´€ë ¨ ê¸ì •ì  ë¶„ì„
    if (fullText.includes('ì„œë¹„ìŠ¤') || fullText.includes('ì•±ìŠ¤í† ì–´')) {
      return {
        sentiment: 'positive',
        score: 1,
        reasoning: `ì• í”Œì˜ ì„œë¹„ìŠ¤ ì‚¬ì—…ì´ ë¶„ê¸° ë§¤ì¶œ 200ì–µë‹¬ëŸ¬ë¥¼ ëŒíŒŒí•˜ë©° ì „ì²´ ë§¤ì¶œì˜ 25%ê¹Œì§€ í™•ëŒ€ë˜ë©´ì„œ í•˜ë“œì›¨ì–´ ì¤‘ì‹¬ì—ì„œ ì†Œí”„íŠ¸ì›¨ì–´ ì¤‘ì‹¬ì˜ ìˆ˜ìµ êµ¬ì¡°ë¡œ ì „í™˜ì´ ê°€ì†í™”ë˜ê³  ìžˆìŠµë‹ˆë‹¤. ì•±ìŠ¤í† ì–´ 30% ìˆ˜ìˆ˜ë£Œ, ì•„ì´í´ë¼ìš°ë“œ êµ¬ë…ë£Œ, ì• í”Œë®¤ì§, ì• í”ŒTV+ ë“± êµ¬ë… ì„œë¹„ìŠ¤ë“¤ì´ ì•ˆì •ì ì¸ ê²½ìƒ ìˆ˜ìµì„ ì°½ì¶œí•˜ë©° ê³„ì ˆì  ë³€ë™ì„±ì´ í° í•˜ë“œì›¨ì–´ ë§¤ì¶œì„ ë³´ì™„í•˜ê³  ìžˆìœ¼ë©°, íŠ¹ížˆ ì„œë¹„ìŠ¤ ì‚¬ì—…ì˜ 70% ì´ìƒ ë§ˆì§„ìœ¨ì€ í•˜ë“œì›¨ì–´ ì‚¬ì—… ëŒ€ë¹„ 2ë°°ì—ì„œ 3ë°° ë†’ì•„ ì• í”Œì˜ ì „ì²´ ìˆ˜ìµì„± ê°œì„ ì— í•µì‹¬ ì—­í• ì„ í•˜ê³  ìžˆê³  ì „ ì„¸ê³„ 20ì–µê°œ ì´ìƒì˜ í™œì„± ì• í”Œ ê¸°ê¸°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ê±°ëŒ€í•œ ì‚¬ìš©ìž ë² ì´ìŠ¤ëŠ” ì§€ì†ì ì¸ ì„œë¹„ìŠ¤ í™•ìž¥ì˜ ê°•ë ¥í•œ ê¸°ë°˜ì´ ë˜ê³  ìžˆìŠµë‹ˆë‹¤`
      };
    }
    
    // ê¸°ë³¸ ì¤‘ë¦½ì  ë¶„ì„
    return {
      sentiment: 'neutral',
      score: 0,
      reasoning: `ì• í”Œì€ ì „ ì„¸ê³„ 20ì–µê°œ ì´ìƒì˜ í™œì„± ê¸°ê¸°ë¥¼ ë³´ìœ í•œ ê±°ëŒ€í•œ ìƒíƒœê³„ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•˜ë“œì›¨ì–´ì™€ ì†Œí”„íŠ¸ì›¨ì–´ì™€ ì„œë¹„ìŠ¤ê°€ ì™„ë²½ížˆ í†µí•©ëœ ë…íŠ¹í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³  ìžˆìœ¼ë©°, ì´ëŠ” ê³ ê° ì¶©ì„±ë„ì™€ ì „í™˜ ë¹„ìš© ìž¥ë²½ì„ ë†’ì—¬ ì§€ì†ì ì¸ í”„ë¦¬ë¯¸ì—„ ê°€ê²© ì •ì±…ê³¼ ì•ˆì •ì  ìˆ˜ìµ ì°½ì¶œì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê³  ìžˆì§€ë§Œ ì¤‘êµ­ ì‹œìž¥ì—ì„œì˜ ì§€ì •í•™ì  ë¦¬ìŠ¤í¬ì™€ AI ê¸°ìˆ  ê²½ìŸì—ì„œì˜ ìƒëŒ€ì  ì—´ì„¸ ìš°ë ¤ì— ëŒ€í•œ ë©´ë°€í•œ ëª¨ë‹ˆí„°ë§ì´ í•„ìš”í•œ ìƒí™©ìž…ë‹ˆë‹¤`
    };
  }

  analyzeGeneralComplete(fullText, post, ticker) {
    // ê¸°íƒ€ ì¢…ëª©ë“¤ì˜ ê¸°ë³¸ ë¶„ì„
    const positiveKeywords = ['ì„±ìž¥', 'í˜¸ì¡°', 'ìƒìŠ¹', 'í˜¸ìž¬', 'ê¸ì •', 'íˆ¬ìž', 'í™•ëŒ€', 'ê°œì„ '];
    const negativeKeywords = ['í•˜ë½', 'ë¶€ì§„', 'ì•…ìž¬', 'ìš°ë ¤', 'ë¦¬ìŠ¤í¬', 'ê°ì†Œ', 'ì•…í™”', 'ìœ„í—˜'];
    
    const hasPositive = positiveKeywords.some(keyword => fullText.includes(keyword));
    const hasNegative = negativeKeywords.some(keyword => fullText.includes(keyword));
    
    if (hasPositive && !hasNegative) {
      return {
        sentiment: 'positive',
        score: 1,
        reasoning: `í•´ë‹¹ ê¸°ì—…ì˜ ì‚¬ì—… í™˜ê²½ê³¼ ì‹œìž¥ ìƒí™©ì´ ê°œì„ ë˜ê³  ìžˆëŠ” ê²ƒìœ¼ë¡œ í‰ê°€ë˜ë©°, ê¸ì •ì ì¸ ì„±ìž¥ ë™ë ¥ê³¼ ì‹œìž¥ ê¸°íšŒ ìš”ì†Œë“¤ì´ ë¶€ê°ë˜ê³  ìžˆì–´ íˆ¬ìžìžë“¤ì˜ ê¸°ëŒ€ê°ì´ ë†’ì•„ì§€ê³  ìžˆëŠ” ìƒí™©ìž…ë‹ˆë‹¤. ë‹¤ë§Œ ê±°ì‹œê²½ì œ í™˜ê²½ê³¼ ì—…ì¢…ë³„ íŠ¹ì„±ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì—¬ ì‹ ì¤‘í•œ íˆ¬ìž ì ‘ê·¼ì´ í•„ìš”í•  ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤`
      };
    } else if (hasNegative && !hasPositive) {
      return {
        sentiment: 'negative',
        score: -1,
        reasoning: `í•´ë‹¹ ê¸°ì—…ì´ ì§ë©´í•œ ì‚¬ì—… í™˜ê²½ê³¼ ì‹œìž¥ ì—¬ê±´ì— ë¶€ì •ì ì¸ ìš”ì¸ë“¤ì´ ì¦ê°€í•˜ê³  ìžˆì–´ íˆ¬ìžìžë“¤ì˜ ìš°ë ¤ê°€ ì»¤ì§€ê³  ìžˆëŠ” ìƒí™©ìž…ë‹ˆë‹¤. ì‚°ì—… ë‚´ ê²½ìŸ ì‹¬í™”ì™€ ì™¸ë¶€ ë¦¬ìŠ¤í¬ ìš”ì¸ë“¤ì´ ê¸°ì—…ì˜ ì„±ìž¥ì„±ê³¼ ìˆ˜ìµì„±ì— ì••ë°•ì„ ê°€í•˜ê³  ìžˆì–´ ë‹¨ê¸°ì ì¸ ì‹¤ì  ê°œì„ ì´ë‚˜ êµ¬ì¡°ì  ë³€í™”ê°€ í•„ìš”í•œ ì‹œì ìœ¼ë¡œ í‰ê°€ë©ë‹ˆë‹¤`
      };
    } else {
      return {
        sentiment: 'neutral',
        score: 0,
        reasoning: `í•´ë‹¹ ê¸°ì—…ì— ëŒ€í•œ ì‹œìž¥ì˜ í‰ê°€ê°€ ê¸ì •ì  ìš”ì†Œì™€ ë¶€ì •ì  ìš”ì†Œê°€ í˜¼ìž¬ë˜ì–´ ìžˆì–´ ì¤‘ë¦½ì ì¸ ê´€ì ì—ì„œì˜ ì ‘ê·¼ì´ ì ì ˆí•  ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤. ê¸°ì—…ì˜ íŽ€ë”ë©˜í„¸ê³¼ ì‚°ì—… ì „ë§ì„ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ì¤‘ìž¥ê¸°ì  íˆ¬ìž ê°€ì¹˜ë¥¼ í‰ê°€í•˜ê³  ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ í†µí•œ ì‹ ì¤‘í•œ íˆ¬ìž ì „ëžµì´ í•„ìš”í•œ ìƒí™©ìž…ë‹ˆë‹¤`
      };
    }
  }

  async saveSentiment(postId, ticker, analysis, blogPostDate) {
    return new Promise((resolve, reject) => {
      const normalizedDate = blogPostDate.includes('T') ? blogPostDate.split('T')[0] : 
                           blogPostDate.includes(' ') ? blogPostDate.split(' ')[0] : 
                           blogPostDate;
      
      this.db.run(`
        INSERT INTO sentiments (
          post_id, ticker, sentiment, sentiment_score, 
          key_reasoning, created_at
        ) VALUES (?, ?, ?, ?, ?, ?)
      `, [
        postId, ticker, analysis.sentiment, 
        analysis.score, analysis.reasoning, normalizedDate
      ], function(err) {
        if (err) reject(err);
        else resolve(this.lastID);
      });
    });
  }
}

const analyzer = new CompleteSentimentAnalyzer();
analyzer.analyzeAllPostsComplete().catch(console.error);