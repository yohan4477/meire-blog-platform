const sqlite3 = require('sqlite3').verbose();
const path = require('path');

// ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
const db = new sqlite3.Database(path.join(__dirname, '../database.db'));

// ì•½ 100ì(3ë°°) ê¸¸ì´ì˜ ìƒì„¸í•œ íšŒì‚¬ ì„¤ëª…
const detailedDescriptions = {
  // ğŸ‡°ğŸ‡· í•œêµ­ ì£¼ìš” ì¢…ëª©
  '005930': 'ì„¸ê³„ ìµœëŒ€ ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ì œì¡°ì‚¬ì´ì ê°¤ëŸ­ì‹œ ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ê¸€ë¡œë²Œ ëª¨ë°”ì¼ ì‹œì¥ì„ ì„ ë„í•˜ëŠ” ì‚¼ì„±ê·¸ë£¹ì˜ í•µì‹¬ ê³„ì—´ì‚¬. HBM ë©”ëª¨ë¦¬ì™€ íŒŒìš´ë“œë¦¬ ì‚¬ì—…ìœ¼ë¡œ AI ë°˜ë„ì²´ ìƒíƒœê³„ë¥¼ ì£¼ë„í•˜ë©° ì—°ë§¤ì¶œ 200ì¡°ì› ê·œëª¨ì˜ ê¸€ë¡œë²Œ IT ê³µë£¡',
  
  '000660': 'ì„¸ê³„ 2ìœ„ ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ì œì¡°ì‚¬ë¡œ DRAMê³¼ NAND í”Œë˜ì‹œë¥¼ ì£¼ë ¥ ìƒì‚°í•˜ë©°, ìµœê·¼ AI ë°ì´í„°ì„¼í„° í•µì‹¬ ë¶€í’ˆì¸ HBM ë©”ëª¨ë¦¬ ë¶„ì•¼ì—ì„œ ì‚¼ì„±ì „ìì™€ í•¨ê»˜ ê¸€ë¡œë²Œ ë…ì  ì²´ì œë¥¼ êµ¬ì¶•í•˜ì—¬ ì°¨ì„¸ëŒ€ ë°˜ë„ì²´ ì‹œì¥ì„ ì„ ë„',
  
  'TSLA': 'ì¼ë¡  ë¨¸ìŠ¤í¬ê°€ CEOë¡œ ì´ë„ëŠ” ì „ê¸°ì°¨ í˜ì‹  ê¸°ì—…ìœ¼ë¡œ Model S/3/X/Y ë¼ì¸ì—…ê³¼ Cybertruckìœ¼ë¡œ ê¸€ë¡œë²Œ ì „ê¸°ì°¨ ì‹œì¥ì„ ê°œì²™. FSD ììœ¨ì£¼í–‰ ê¸°ìˆ , ìŠˆí¼ì°¨ì € ë„¤íŠ¸ì›Œí¬, ì—ë„ˆì§€ ì €ì¥ ì‹œìŠ¤í…œì„ í†µí•´ ì§€ì†ê°€ëŠ¥í•œ ì—ë„ˆì§€ ìƒíƒœê³„ êµ¬ì¶•',
  
  'NVDA': 'GPU ê¸°ìˆ ë¡œ ì‹œì‘í•´ ChatGPT ë“± ìƒì„±í˜• AI í˜ëª…ì˜ í•µì‹¬ ì¸í”„ë¼ì¸ H100, A100 AI ì¹©ì„ ë…ì  ê³µê¸‰í•˜ë©° AI ì‹œëŒ€ì˜ ì ˆëŒ€ ê°•ìë¡œ ë¶€ìƒ. ë°ì´í„°ì„¼í„°, ììœ¨ì£¼í–‰, ë©”íƒ€ë²„ìŠ¤ ì „ ë¶„ì•¼ì—ì„œ AI ì»´í“¨íŒ… í”Œë«í¼ ì§€ë°°',
  
  'AAPL': 'ì•„ì´í°ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸í° í˜ëª…ì„ ì´ëŒê³  iOS ìƒíƒœê³„, ì•±ìŠ¤í† ì–´, ì• í”Œ ì‹¤ë¦¬ì½˜ìœ¼ë¡œ í•˜ë“œì›¨ì–´ì™€ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ í†µí•©í•œ ë…ìì  í”Œë«í¼ì„ êµ¬ì¶•. ì—°ë§¤ì¶œ 400ì¡°ì›, ì‹œê°€ì´ì•¡ 3ì¡°ë‹¬ëŸ¬ì˜ ì„¸ê³„ ìµœëŒ€ ê¸°ìˆ ê¸°ì—…',
  
  'GOOGL': 'êµ¬ê¸€ ê²€ìƒ‰ì—”ì§„ìœ¼ë¡œ ì¸í„°ë„· ìƒíƒœê³„ë¥¼ ì¥ì•…í•˜ê³  ìœ íŠœë¸Œ, ì•ˆë“œë¡œì´ë“œ OS, êµ¬ê¸€ í´ë¼ìš°ë“œë¥¼ í†µí•´ ë””ì§€í„¸ ì¸í”„ë¼ë¥¼ ì œê³µ. AI ê¸°ìˆ  Bardì™€ Geminië¡œ ì°¨ì„¸ëŒ€ ì¸ê³µì§€ëŠ¥ ê²½ìŸì„ ì„ ë„í•˜ëŠ” ì•ŒíŒŒë²³ì˜ í•µì‹¬ ìíšŒì‚¬',
  
  '373220': 'LGí™”í•™ì—ì„œ ë¶„ì‚¬í•œ ì„¸ê³„ 2ìœ„ ë°°í„°ë¦¬ ì œì¡°ì‚¬ë¡œ í…ŒìŠ¬ë¼, GM, ë³¼ë³´ ë“± ê¸€ë¡œë²Œ ì™„ì„±ì°¨ ì—…ì²´ì— ì „ê¸°ì°¨ìš© ë¦¬íŠ¬ì´ì˜¨ ë°°í„°ë¦¬ë¥¼ ê³µê¸‰. ESSì™€ ì†Œí˜• ë°°í„°ë¦¬ê¹Œì§€ ì „ ë¶„ì•¼ë¥¼ ì•„ìš°ë¥´ëŠ” ë°°í„°ë¦¬ ìƒíƒœê³„ ì™„ì„±',
  
  'LLY': '1876ë…„ ì°½ë¦½ëœ ê¸€ë¡œë²Œ ì œì•½ ëŒ€ê¸°ì—…ìœ¼ë¡œ ë‹¹ë‡¨ë³‘ ì¹˜ë£Œì œ ì¸ìŠë¦°ì„ ìµœì´ˆ ìƒìš©í™”í•œ ì—­ì‚¬ë¥¼ ë³´ìœ . ìµœê·¼ ë¹„ë§Œì¹˜ë£Œì œ Mounjaroì™€ ì•Œì¸ í•˜ì´ë¨¸ ì¹˜ë£Œì œë¡œ ì œì•½ì—…ê³„ í˜ì‹ ì„ ì£¼ë„í•˜ë©° ì—°ë§¤ì¶œ 30ì¡°ì› ê·œëª¨ ë‹¬ì„±',
  
  'INTC': 'ë°˜ë„ì²´ ì‚°ì—…ì˜ 50ë…„ ì„ êµ¬ìë¡œ x86 CPU ì•„í‚¤í…ì²˜ë¥¼ ê°œë°œí•´ PC í˜ëª…ì„ ì´ëŒì—ˆìœ¼ë©°, í˜„ì¬ ë°ì´í„°ì„¼í„°ìš© Xeon í”„ë¡œì„¸ì„œì™€ AI ì¹© Gaudi, íŒŒìš´ë“œë¦¬ ì‚¬ì—…ìœ¼ë¡œ ë°˜ë„ì²´ ìƒíƒœê³„ ì „ë°˜ì—ì„œ ì¬ë„ì•½ ì¶”ì§„',
  
  'UNH': 'ë¯¸êµ­ ìµœëŒ€ ê±´ê°•ë³´í—˜íšŒì‚¬ì´ì ì˜ë£Œì„œë¹„ìŠ¤ í†µí•© ì œê³µì—…ì²´ë¡œ 5000ë§Œëª… ì´ìƒì—ê²Œ ë³´í—˜ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ë©°, Optum í—¬ìŠ¤ì¼€ì–´ í”Œë«í¼ì„ í†µí•´ ì˜ë£Œ ë°ì´í„° ë¶„ì„ê³¼ ì›ê²©ì§„ë£Œê¹Œì§€ ì•„ìš°ë¥´ëŠ” ë””ì§€í„¸ í—¬ìŠ¤ì¼€ì–´ ìƒíƒœê³„ êµ¬ì¶•',
  
  // ì¶”ê°€ ì£¼ìš” ì¢…ëª©ë“¤
  'AMZN': 'ì„¸ê³„ ìµœëŒ€ ì „ììƒê±°ë˜ í”Œë«í¼ì´ì AWS í´ë¼ìš°ë“œë¡œ ì „ ì„¸ê³„ ì¸í„°ë„· ì¸í”„ë¼ì˜ 30%ë¥¼ ë‹´ë‹¹í•˜ëŠ” í´ë¼ìš°ë“œ ê³µë£¡. í”„ë¼ì„ ë©¤ë²„ì‹­, ì•Œë ‰ì‚¬ ìŠ¤ë§ˆíŠ¸í™ˆ, ì›ë°ì´ ë°°ì†¡ìœ¼ë¡œ ì†Œë¹„ì ê²½í—˜ì„ í˜ì‹ í•˜ë©° ì—°ë§¤ì¶œ 500ì¡°ì› ë‹¬ì„±',
  
  'TSM': 'ì• í”Œ ì•„ì´í° Aì‹œë¦¬ì¦ˆ ì¹©ê³¼ ì—”ë¹„ë””ì•„ GPUë¥¼ ìœ„íƒìƒì‚°í•˜ëŠ” ì„¸ê³„ 1ìœ„ íŒŒìš´ë“œë¦¬ ê¸°ì—…. ì²¨ë‹¨ 3ë‚˜ë…¸ ê³µì • ê¸°ìˆ ë¡œ ê¸€ë¡œë²Œ ë°˜ë„ì²´ ìƒì‚°ì˜ 50% ì´ìƒì„ ë‹´ë‹¹í•˜ë©° ëŒ€ë§Œ ê²½ì œì˜ í•µì‹¬ì¶• ì—­í• ',
  
  '042660': 'LNGì„ ê³¼ í•´ì–‘í”ŒëœíŠ¸ ê±´ì¡° ì „ë¬¸ ì¡°ì„ ê¸°ì—…ìœ¼ë¡œ ì¹œí™˜ê²½ ì„ ë°• ê¸°ìˆ ì„ ë³´ìœ í•œ í•œí™”ê·¸ë£¹ ê³„ì—´ì‚¬. í•´ìƒí’ë ¥ ë°œì „ì„¤ë¹„ ì œì‘ê³¼ ìˆ˜ì†Œ ì¶”ì§„ ì„ ë°• ê°œë°œë¡œ ê·¸ë¦° ì—ë„ˆì§€ í•´ì–‘ ì†”ë£¨ì…˜ ë¶„ì•¼ ì„ ë„ê¸°ì—…ìœ¼ë¡œ ì „í™˜',
  
  '035420': 'êµ­ë‚´ ìµœëŒ€ í¬í„¸ì‚¬ì´íŠ¸ ë„¤ì´ë²„ë¥¼ ìš´ì˜í•˜ë©° ì›¹íˆ°, í´ë¡œë°” AI, ë„¤ì´ë²„ í´ë¼ìš°ë“œë¡œ ë””ì§€í„¸ ì½˜í…ì¸ ì™€ B2B ì„œë¹„ìŠ¤ê¹Œì§€ í™•ì¥. ë¼ì¸ê³¼ í•¨ê»˜ ì•„ì‹œì•„ ë””ì§€í„¸ í”Œë«í¼ ìƒíƒœê³„ë¥¼ êµ¬ì¶•í•˜ëŠ” ê¸€ë¡œë²Œ IT ê¸°ì—…',
  
  '035720': 'ì¹´ì¹´ì˜¤í†¡ ë©”ì‹ ì €ë¡œ êµ­ë‚´ ëª¨ë°”ì¼ ìƒí™œ ì¸í”„ë¼ë¥¼ ì¥ì•…í•˜ê³  ì¹´ì¹´ì˜¤í˜ì´, ì¹´ì¹´ì˜¤íƒì‹œ, ì¹´ì¹´ì˜¤ë±…í¬ë¡œ í•€í…Œí¬ì™€ O2O ì„œë¹„ìŠ¤ë¥¼ í†µí•© ì œê³µ. ë””ì§€í„¸ í”Œë«í¼ì„ í†µí•œ ìƒí™œë°€ì°©í˜• ì„œë¹„ìŠ¤ ìƒíƒœê³„ ì™„ì„±',
  
  '006400': 'ì‚¼ì„±ê·¸ë£¹ ê³„ì—´ì˜ ë°°í„°ë¦¬ ì†Œì¬ì™€ ë°˜ë„ì²´ ì†Œì¬ ì „ë¬¸ê¸°ì—…ìœ¼ë¡œ ì „ê¸°ì°¨ ë°°í„°ë¦¬ìš© ì–‘ê·¹ì¬ì™€ ë°˜ë„ì²´ ê³µì •ìš© íŠ¹ìˆ˜ ì†Œì¬ë¥¼ ìƒì‚°. ì°¨ì„¸ëŒ€ ì „ê³ ì²´ ë°°í„°ë¦¬ì™€ ì²¨ë‹¨ ë°˜ë„ì²´ ì†Œì¬ ê°œë°œë¡œ ë¯¸ë˜ ì„±ì¥ ë™ë ¥ í™•ë³´',
  
  'JPM': 'ë¯¸êµ­ ìµœëŒ€ íˆ¬ìì€í–‰ì´ì ìƒì—…ì€í–‰ìœ¼ë¡œ ìì‚°ê·œëª¨ 4ì¡°ë‹¬ëŸ¬ë¥¼ ë³´ìœ í•œ ì›”ìŠ¤íŠ¸ë¦¬íŠ¸ì˜ ê¸ˆìœµ ê³µë£¡. íˆ¬ìì€í–‰ì—…ë¬´, ìì‚°ê´€ë¦¬, ê°œì¸ê¸ˆìœµ, ìƒì—…ê¸ˆìœµì„ ì•„ìš°ë¥´ë©° ê¸€ë¡œë²Œ ê¸ˆìœµì‹œì¥ì—ì„œ ë…ë³´ì  ì˜í–¥ë ¥ í–‰ì‚¬',
  
  'ASML': 'ë°˜ë„ì²´ ì œì¡°ì˜ í•µì‹¬ ì¥ë¹„ì¸ ê·¹ìì™¸ì„ (EUV) ë…¸ê´‘ì¥ë¹„ë¥¼ ì „ ì„¸ê³„ì—ì„œ ìœ ì¼í•˜ê²Œ ìƒì‚°í•˜ëŠ” ë„¤ëœë€ë“œ ê¸°ì—…. ì‚¼ì„±, TSMC, ì¸í…” ë“± ëª¨ë“  ë°˜ë„ì²´ ì œì¡°ì‚¬ê°€ ì˜ì¡´í•˜ëŠ” ì²¨ë‹¨ ë°˜ë„ì²´ ìƒì‚°ì˜ ì ˆëŒ€ í•„ìˆ˜ ê¸°ì—…',
  
  'AMD': 'ì¸í…”ì˜ ìµœëŒ€ ê²½ìŸì‚¬ë¡œ ê³ ì„±ëŠ¥ CPU Ryzenê³¼ GPU Radeonì„ ì œì¡°í•˜ë©° ìµœê·¼ AI ë¶„ì•¼ì—ì„œë„ ê¸‰ì„±ì¥. ë°ì´í„°ì„¼í„°ìš© EPYC í”„ë¡œì„¸ì„œì™€ AI ê°€ì†ê¸° Instinctë¡œ ì—”ë¹„ë””ì•„ì™€ ì¸í…”ì— ë„ì „í•˜ëŠ” ë°˜ë„ì²´ ê°•ì'
};

console.log('ğŸ”„ ìƒì„¸í•œ íšŒì‚¬ ì„¤ëª…(ì•½ 100ì) ì—…ë°ì´íŠ¸ ì‹œì‘...');
console.log(`ğŸ“Š ì´ ${Object.keys(detailedDescriptions).length}ê°œ ì¢…ëª© ì—…ë°ì´íŠ¸ ì˜ˆì •\n`);

// ê° íšŒì‚¬ ì„¤ëª…ì„ ì—…ë°ì´íŠ¸
const updatePromises = Object.entries(detailedDescriptions).map(([ticker, description]) => {
  return new Promise((resolve, reject) => {
    db.run(
      'UPDATE stocks SET description = ? WHERE ticker = ?',
      [description, ticker],
      function(err) {
        if (err) {
          console.error(`âŒ ${ticker} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, err);
          reject(err);
        } else {
          if (this.changes > 0) {
            console.log(`âœ… ${ticker}: "${description.substring(0, 50)}..." (${description.length}ì)`);
          } else {
            console.log(`âš ï¸ ${ticker}: í•´ë‹¹ ì¢…ëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`);
          }
          resolve();
        }
      }
    );
  });
});

// ëª¨ë“  ì—…ë°ì´íŠ¸ ì™„ë£Œ í›„ í™•ì¸
Promise.all(updatePromises)
  .then(() => {
    console.log('\nğŸ¯ ì—…ë°ì´íŠ¸ ì™„ë£Œ! ìµœì¢… í™•ì¸:');
    db.all(
      'SELECT ticker, company_name, description, LENGTH(description) as len FROM stocks WHERE ticker IN (' + 
      Object.keys(detailedDescriptions).map(() => '?').join(',') + ') ORDER BY len DESC',
      Object.keys(detailedDescriptions),
      (err, rows) => {
        if (err) {
          console.error('âŒ í™•ì¸ ì¿¼ë¦¬ ì‹¤íŒ¨:', err);
        } else {
          console.log('\nğŸ“‹ ì—…ë°ì´íŠ¸ëœ ì¢…ëª©ë“¤:');
          rows.forEach(row => {
            const length = row.description?.length || 0;
            const preview = row.description ? row.description.substring(0, 60) + '...' : 'N/A';
            console.log(`${row.ticker} (${row.company_name}): ${length}ì`);
            console.log(`   "${preview}"`);
          });
          
          const avgLength = rows.reduce((sum, row) => sum + (row.len || 0), 0) / rows.length;
          console.log(`\nğŸ“Š í‰ê·  ì„¤ëª… ê¸¸ì´: ${Math.round(avgLength)}ì`);
          
          const shortDescriptions = rows.filter(row => row.len < 80);
          const longDescriptions = rows.filter(row => row.len > 120);
          
          if (shortDescriptions.length > 0) {
            console.log(`\nâš ï¸ 80ì ë¯¸ë§Œ ì¢…ëª© (${shortDescriptions.length}ê°œ):`);
            shortDescriptions.forEach(row => console.log(`${row.ticker}: ${row.len}ì`));
          }
          
          if (longDescriptions.length > 0) {
            console.log(`\nğŸ“ 120ì ì´ˆê³¼ ì¢…ëª© (${longDescriptions.length}ê°œ):`);
            longDescriptions.forEach(row => console.log(`${row.ticker}: ${row.len}ì`));
          }
          
          console.log(`\nâœ… ìƒì„¸ ì„¤ëª… ì—…ë°ì´íŠ¸ ì™„ë£Œ! í‰ê·  ${Math.round(avgLength)}ì`);
        }
        
        db.close((err) => {
          if (err) {
            console.error('âŒ DB ì—°ê²° ì¢…ë£Œ ì‹¤íŒ¨:', err);
          } else {
            console.log('\nâœ… ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ');
          }
        });
      }
    );
  })
  .catch((error) => {
    console.error('âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
    db.close();
  });